include $(DEVKITARM)/ds_rules

OBJDUMP	:=	$(PREFIX)objdump

#arm9-disassembled.s: arm9.bin
#	$(OBJDUMP) -D -b binary -m arm arm9.bin > arm9-disassembled.s

all: FIFA06.sav FIFA07.sav FIFA08.sav FIFA09.sav

FIFA06.sav:
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA06=1 -o FIFA06.elf
	$(OBJCOPY) -O binary FIFA06.elf $@
	@rm -f FIFA06.elf
	
	../CRCFix/CRCFix $@ -f

FIFA07.sav: source/*.s
	$(CC) -nostartfiles -nostdlib source/*.s -o FIFA07.elf -Ttext=0x20021A32
	$(OBJCOPY) -O binary FIFA07.elf arm9.bin
	@rm -f FIFA07.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA07=1 -o FIFA07.elf -Ttext=0x20021A32
	$(OBJCOPY) -O binary FIFA07.elf $@
	@rm -f FIFA07.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA08.sav: source/*.s
	$(CC) -nostartfiles -nostdlib source/*.s -o FIFA08.elf -Ttext=0x0028cf40
	$(OBJCOPY) -O binary FIFA08.elf arm9.bin
	@rm -f FIFA08.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA08=1 -o FIFA08.elf -Ttext=0x0028cf40
	$(OBJCOPY) -O binary FIFA08.elf $@
	@rm -f FIFA08.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA09.sav: source/*.s
	$(CC) -nostartfiles -nostdlib source/*.s -o FIFA09.elf -Ttext=0x0028cf40
	$(OBJCOPY) -O binary FIFA09.elf arm9.bin
	@rm -f FIFA09.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA09=1 -o FIFA09.elf -Ttext=0x0028cf40
	$(OBJCOPY) -O binary FIFA09.elf $@
	@rm -f FIFA09.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f