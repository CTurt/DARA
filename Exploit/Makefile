include $(DEVKITARM)/ds_rules

OBJDUMP	:=	$(PREFIX)objdump

#arm9-disassembled.s: arm9.bin
#	$(OBJDUMP) -D -b binary -m arm arm9.bin > arm9-disassembled.s

all: FIFA06E.sav FIFA07E.sav FIFA07U.sav FIFA08E.sav FIFA09E.sav FIFA10E.sav FIFAStreet2E.sav FIFAStreet2U.sav FIFAStreet3E.sav

FIFA06E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFA06.elf -Ttext=0x02243af4
	$(OBJCOPY) -O binary FIFA06.elf arm9.bin
	@rm -f FIFA06.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA06E=1 -o FIFA06.elf -Ttext=0x02243af4
	$(OBJCOPY) -O binary FIFA06.elf $@
	@rm -f FIFA06.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA07E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFA07.elf -Ttext=0x02224f08
	$(OBJCOPY) -O binary FIFA07.elf arm9.bin
	@rm -f FIFA07.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA07E=1 -o FIFA07.elf -Ttext=0x02224f08
	$(OBJCOPY) -O binary FIFA07.elf $@
	@rm -f FIFA07.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA07U.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFA07.elf -Ttext=0x02224f08
	$(OBJCOPY) -O binary FIFA07.elf arm9.bin
	@rm -f FIFA07.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA07U=1 -o FIFA07.elf -Ttext=0x02224f08
	$(OBJCOPY) -O binary FIFA07.elf $@
	@rm -f FIFA07.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA08E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFA08.elf -Ttext=0x0228cf40
	$(OBJCOPY) -O binary FIFA08.elf arm9.bin
	@rm -f FIFA08.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA08E=1 -o FIFA08.elf -Ttext=0x0228cf40
	$(OBJCOPY) -O binary FIFA08.elf $@
	@rm -f FIFA08.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA09E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFA09.elf -Ttext=0x0228af40
	$(OBJCOPY) -O binary FIFA09.elf arm9.bin
	@rm -f FIFA09.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA09E=1 -o FIFA09.elf -Ttext=0x0228af40
	$(OBJCOPY) -O binary FIFA09.elf $@
	@rm -f FIFA09.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFA10E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFA10.elf -Ttext=0x0229c5d8
	$(OBJCOPY) -O binary FIFA10.elf arm9.bin
	@rm -f FIFA10.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFA10E=1 -o FIFA10.elf -Ttext=0x0229c5d8
	$(OBJCOPY) -O binary FIFA10.elf $@
	@rm -f FIFA10.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFAStreet2E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFAStreet2.elf -Ttext=0x02280270
	$(OBJCOPY) -O binary FIFAStreet2.elf arm9.bin
	@rm -f FIFAStreet2.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFAStreet2E=1 -o FIFAStreet2.elf -Ttext=0x02280270
	$(OBJCOPY) -O binary FIFAStreet2.elf $@
	@rm -f FIFAStreet2.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFAStreet2U.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFAStreet2.elf -Ttext=0x02280270
	$(OBJCOPY) -O binary FIFAStreet2.elf arm9.bin
	@rm -f FIFAStreet2.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFAStreet2U=1 -o FIFAStreet2.elf -Ttext=0x02280270
	$(OBJCOPY) -O binary FIFAStreet2.elf $@
	@rm -f FIFAStreet2.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f

FIFAStreet3E.sav: source/*.s
	$(CC) -nostartfiles -nostdlib -x assembler-with-cpp source/*.s -o FIFAStreet3.elf -Ttext=0x020ad3d0
	$(OBJCOPY) -O binary FIFAStreet3.elf arm9.bin
	@rm -f FIFAStreet3.elf
	
	$(CC) -nostartfiles -nostdlib structure/save.s -Wa,--defsym,FIFAStreet3E=1 -o FIFAStreet3.elf -Ttext=0x020ad3d0
	$(OBJCOPY) -O binary FIFAStreet3.elf $@
	@rm -f FIFAStreet3.elf
	@rm -f arm9.bin
	
	../CRCFix/CRCFix $@ -f
